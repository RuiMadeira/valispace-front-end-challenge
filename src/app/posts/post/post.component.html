<mat-card>
    <mat-card-header>

        <mat-card-title *ngIf="this.isNewPost">Create new post</mat-card-title>
        
        <mat-card-title *ngIf="!this.isNewPost">{{this.getEmployeeUsernameFromId(post?.employeeId)}}</mat-card-title>
        <div *ngIf="!this.isNewPost" class="post-card-dates">
            <mat-card-subtitle *ngIf="post?.edited">Edited - {{post?.edited | date : 'yyyy-MM-dd'}}</mat-card-subtitle>
            <mat-card-subtitle>Created - {{post?.created | date : 'yyyy-MM-dd'}}</mat-card-subtitle>
        </div>

    </mat-card-header>
    <mat-card-content>
        
        <form *ngIf="this.isNewPost && !this.isPreviewing" class="new-post-form">
            <mat-form-field [floatLabel]="'never'" class="new-post-form-field">
                <textarea matInput cdkTextareaAutosize name="post" class="new-post" placeholder="Write a new post..."
                (focus)="this.newPost()" (blur)="this.onBlurNewPost()" [ngModel]="post?.text" 
                (ngModelChange)="post ? post.text = $event : null"
                [mentionConfig]="mentionConfig" (searchTerm)="this.getMentionList($event)"></textarea>
            </mat-form-field>
        </form>

        <form *ngIf="!this.isNewPost && this.isEditing && !this.isPreviewing" class="new-post-form">
            <mat-form-field [floatLabel]="'never'" class="new-post-form-field">
                <textarea matInput cdkTextareaAutosize name="post" class="new-post" placeholder="Edit the post..."
                [ngModel]="post?.text" (ngModelChange)="post ? post.text = $event : null"
                [mentionConfig]="mentionConfig" (searchTerm)="this.getMentionList($event)"></textarea>
            </mat-form-field>
        </form>

        <app-post-text *ngIf="!this.isNewPost && (!this.isEditing || this.isPreviewing)" [post]="post"></app-post-text>
        <app-post-text *ngIf="this.isNewPost && this.isPreviewing" [post]="post"></app-post-text>

    </mat-card-content>
    <mat-card-actions>
    <div class="edit-post-buttons" *ngIf="this.isEditing">
        <button mat-raised-button *ngIf="!this.isPreviewing" [disabled]="!post?.text" (click)="this.startPreviewing()">Preview</button>
        <button mat-raised-button *ngIf="this.isPreviewing" class="manage-employee-button" (click)="this.startEditing()">Edit</button>
        <button mat-raised-button color="primary" *ngIf="this.isNewPost" [disabled]="!post?.text" (click)="this.createPost()">Create</button>
        <button mat-raised-button color="primary" *ngIf="!this.isNewPost" [disabled]="!post?.text" (click)="this.editPost()">Confirm</button>
        <button mat-raised-button color="warn" (click)="this.cancelEditing()">Cancel</button>
    </div>
    <div class="edit-post-buttons" *ngIf="!this.isNewPost && !this.isEditing">
        <button mat-raised-button class="manage-employee-button" (click)="this.startEditing()">Edit</button>
    </div>
    </mat-card-actions>
</mat-card>